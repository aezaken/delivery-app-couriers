# Dispatcher App

Приложение для диспетчеров службы доставки. Позволяет управлять заказами, назначать курьеров, отслеживать их местоположение в реальном времени и управлять всей логистикой.

## Основные функции

- **Панель управления:** Главный экран с вкладками заказов и карты.
- **Управление заказами:** Создание новых заказов, просмотр списка всех заказов, назначение курьеров.
- **Карта в реальном времени:** Отображение всех активных курьеров на карте Яндекса.
- **Назначение курьеров:** Выбор курьера для заказа с учётом его текущего местоположения и загруженности.
- **Автодополнение адреса:** Поиск и выбор адреса при создании заказа.
- **WebSocket соединение:** Реальное время обновления данных о курьерах и заказах.

## Архитектура и технологии

Приложение построено на Flutter с использованием архитектуры Provider для управления состоянием.

### Основные зависимости

- **Provider:** Для управления гловальным состоянием приложения.
- **Yandex Maps Mapkit:** `yandex_maps_mapkit` для отображения карты и поиска геоданных.
- **Геолокация:** `geolocator` для работы с геопозицией (при необходимости).
- **WebSocket:** `web_socket_channel` для реального времени обмена данными с сервером.
- **HTTP-запросы:** `http` для разовых запросов к API.
- **Утилиты:** `flutter_dotenv` для загрузки конфигурации из .env файла.

### Структура проекта

```
lib/
├── main.dart                    # Точка входа, инициализация приложения
├── pages/                      # Экраны приложения
│   ├── create_order_page.dart  # Экран создания заказа
│   ├── map_view_page.dart      # Экран карты с курьерами
│   └── orders_list_view.dart   # Экран списка заказов
├── models/                     # Модели данных
├── services/                   # Сервисы для работы с API и WebSocket
│   ├── order_service.dart      # Управление заказами
│   ├── courier_service.dart    # Управление курьерами
│   └── websocket_service.dart  # Подключение и обработка сообщений WebSocket
├── utils/                      # Вспомогательные утилиты
└── widgets/                    # Повторно используемые виджеты
```

### Интеграция с Yandex Maps

Приложение использует `yandex_maps_mapkit` для отображения карты. API-ключ загружается из `.env` файла для безопасности.

### WebSocket соединение

При запуске приложение устанавливает WebSocket соединение с бэкендом. Через это соединение приходят:
- Обновления позиций курьеров в реальном времени
- Уведомления о новых заказах
- Изменения статусов заказов

### Управление состоянием

Используется Provider для управления состоянием заказов и курьеров. Все данные, полученные через WebSocket, обновляют глобальное состояние, что автоматически перестраивает интерфейс.

## Запуск приложения

1. Убедитесь, что установлен Flutter SDK.
2. Создайте файл `.env` на основе `.env.example` и вставьте ваш API-ключ Яндекс Карт:
   ```bash
   cp .env.example .env
   # Отредактируйте .env и вставьте ваш ключ
   ```
3. Установите зависимости:
   ```bash
   flutter pub get
   ```
4. Запустите приложение:
   ```bash
   flutter run
   ```

Приложение загрузит конфигурацию, инициализирует карту и подключится к серверу для получения данных в реальном времени.